@startuml Context
!include <C4/C4_Container>

Person(personAlias, "Клиент", "Подает заявку на подключение домашнего интернета")
System_Boundary(systemAlias, "Система заявок") {
    Container(feContainerAlias, "Веб-сайт оператора связи", "JavaScript and React", "Предоставляет форму создания новой заявки")
    Container(mobileAppContainerAlias, "Мобильное приложение оператора связи", "Andoid/IOS and Kotlin Multiplatform", "Предоставляет возможность определения текущего местоположения, создания новой заявки")
    Container(beContainerAlias, "Бэкенд-приложение оператора связи", "Java/Kotlin and Akka", "Предоставляет функциональность системы заявок через. API JSON/HTTPS")
    Container(beRequestsContainerAlias, "Сервис проверки доступности подключения", "Java/Kotlin and Akka", "Проверяет адрес на доступность подключения. Если БД адресов не доступна, то заводит задачу для последующей проверки адреса. API JSON/HTTPS")
    Container(beNotificationsContainerAlias, "Сервис отправки уведомлений", "Java/Kotlin and Akka", "Позволяет отправлять сообщения на email или через push нотификации. API JSON/HTTPS")
    ContainerDb(dbAllContainerAlias, "База данных всех адресов")
    ContainerDb(dbAvailableContainerAlias, "База данных адресов доступных для подключения")
    ContainerDb(dbCheckTasksContainerAlias, "База данных задач на проверку доступности к подключению")

}
System_Ext(geoIpSystemAlias, "Geo IP System", "Система для определения местоположения по IP-адресу или координатам GPS")
System_Ext(emailSystemAlias, "Email System", "Система для отправки email сообщений")
System_Ext(pushSystemAlias, "Push Notifications System", "Система для отправки push уведомлений")

Rel(personAlias, feContainerAlias, "Поиск адреса, проверка возможности подключения, оформление заявки", "HTTPS")
Rel(personAlias, mobileAppContainerAlias, "Поиск адреса, проверка возможности подключения, оформление заявки")
Rel(feContainerAlias, beContainerAlias, "Вызов API", "JSON/HTTPS")
Rel(mobileAppContainerAlias, beContainerAlias, "Вызов API", "JSON/HTTPS")
Rel(beContainerAlias, dbAllContainerAlias, "Чтение", "JDBC")
Rel_D(beContainerAlias, geoIpSystemAlias, "Получить адрес по IP-адресу или координатам GPS", "JSON/HTTPS")
Rel_D(beContainerAlias, beRequestsContainerAlias, "Проверить адрес на доступность подключения")
Rel(beRequestsContainerAlias, dbAvailableContainerAlias, "Чтение", "JDBC")
Rel(beRequestsContainerAlias, dbCheckTasksContainerAlias, "Чтение/Запись", "JDBC")
Rel(beRequestsContainerAlias, beNotificationsContainerAlias, "Вызов API", "JSON/HTTPS")
Rel(beNotificationsContainerAlias, emailSystemAlias, "Отправить сообщение по email")
Rel(beNotificationsContainerAlias, pushSystemAlias, "Отправить push нотификацию на телефон")
Rel(emailSystemAlias, personAlias, "Отправляет email сообщение клиенту")
Rel(pushSystemAlias, mobileAppContainerAlias, "Отправляет push нотификацию")

SHOW_LEGEND()
@enduml
